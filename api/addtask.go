package api
// 1Ô∏è‚É£ –®–û, –û–ü–Ø–¢–¨ –ì–û–õ–´–ô package?!!? üò±
// –î–∞, –±—Ä–æ, —ç—Ç–æ —Å–≤—è—Ç–∞—è –æ–±—è–∑–∞–Ω–Ω–æ—Å—Ç—å Go-–ø—Ä–æ–≥—Ä–∞–º–º–∏—Å—Ç–∞ ‚Äî —Å–∫–∞–∑–∞—Ç—å ¬´package api¬ª,
// —á—Ç–æ–±—ã –≥–æ–Ω—è—Ç—å –Ω–∞—à–∏—Ö –ø—Ä–µ–∫—Ä–∞—Å–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π –≤ —Ä–∞–º–∫–∞—Ö –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–∞ –∏–º—ë–Ω "api".
// –ò–Ω–∞—á–µ Go –≤–∑–æ—Ä–≤—ë—Ç—Å—è —Ä–∞–Ω–¥–æ–º–Ω—ã–º –≤—ã—Å—Ç—Ä–µ–ª–æ–º –∏–∑ –ª–∞–∑–µ—Ä–Ω–æ–≥–æ –∫–æ—Ç–∞! üê±üî´

import (
    "encoding/json"
    // 2Ô∏è‚É£ –û–ì–û, –ö–£–î–ê –ú–´ –ü–û–ü–ê–õ–ò? –í –î–ï–ë–†–ò JSON! ü§Ø
    // –≠—Ç–æ—Ç –ø–∞–∫–µ—Ç –ø–æ–º–æ–≥–∞–µ—Ç –Ω–∞–º –æ–±—â–∞—Ç—å—Å—è —Å –∫–ª–∏–µ–Ω—Ç–∞–º–∏ –Ω–∞ —è–∑—ã–∫–µ JSON,
    // –ø—Ä–µ–≤—Ä–∞—â–∞—è –Ω–∞—à—É Go-—Å—Ç—Ä—É–∫—Ç—É—Ä—É –≤ —É–Ω—ã–ª—ã–π —Ç–µ–∫—Å—Ç –∏ –æ–±—Ä–∞—Ç–Ω–æ. 

    "fmt"
    // 3Ô∏è‚É£ –†–∞–∑—Ä–µ—à–∏—Ç–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–∏—Ç—å—Å—è: –ø–∞–∫–µ—Ç "fmt". –ó–≤–µ–∑–¥–∞ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∏ –ª–∏—Ö–∏—Ö –ø—Ä–∏–±–∞—É—Ç–æ–∫. ü§°
    // –ï—Å–ª–∏ –≤–∞–º –Ω—É–∂–Ω–∞ —Å—Ç—Ä–æ–∫–∞ –ø–æ —Ç–∏–ø—É "–ó–∞–≥–æ–ª–æ–≤–æ–∫: %s" ‚Äî —Å—é–¥–∞, –≤–æ—Ç –æ–Ω –≤–∞—Å –æ—Ñ–æ—Ä–º–∏—Ç –ø–æ –∫—Ä–∞—Å–æ—Ç–µ.

    "log"
    // 4Ô∏è‚É£ –ü–∞–∫–µ—Ç "log" ‚Äî –≤–∞—à –ª—É—á—à–∏–π –¥—Ä—É–≥, –∫–æ–≥–¥–∞ –≤—Å—ë –∏–¥–µ—Ç **–Ω–µ** –ø–æ –ø–ª–∞–Ω—É. üòà
    // –í–ø–∏—Ö–∏–≤–∞–µ—à—å —Ç—É–¥–∞ –æ—à–∏–±–∫—É ‚Äî –æ–Ω —Ç–µ–±–µ –ª—é–±–µ–∑–Ω–æ –≤—ã–≤–æ—Ä–∞—á–∏–≤–∞–µ—Ç –µ—ë –Ω–∞–∏–∑–Ω–∞–Ω–∫—É
    // –≤–º–µ—Å—Ç–µ —Å –∫–æ–Ω—Ñ–µ—Ç—Ç–∏ –∏ —Ñ–µ–π–µ—Ä–≤–µ—Ä–∫–∞–º–∏. üéâ

    "net/http"
    // 5Ô∏è‚É£ –ú–∞—Ç—å –µ–≥–æ, –¥–∞ —ç—Ç–æ –∂–µ "net/http"! üöÄ
    // –ö–æ—Ä–æ—á–µ, –±–µ–∑ —ç—Ç–æ–≥–æ –∂–∏—Ç—å –±—ã–ª–æ –±—ã —Å–∫—É—á–Ω–æ, –≤–µ–¥—å –∏–º–µ–Ω–Ω–æ –æ–Ω –ø–æ–¥–Ω–∏–º–∞–µ—Ç –Ω–∞—à–∏ HTTP-—Å–µ—Ä–≤–µ—Ä–∞.
    // –ö–∞–∫ –≥–æ–≤–æ—Ä–∏—Ç—Å—è: "Hello, server! Hello, client! Let's dance! üíÉ".

    "time"
    // 6Ô∏è‚É£ "time" ‚Äî –ª—É—á—à–∏–π —á—É–≤–∞–∫ –¥–ª—è –ø—É—Ç–µ—à–µ—Å—Ç–≤–∏–π –≤–æ –≤—Ä–µ–º–µ–Ω–∏, —á—Ç–æ–±—ã —É–ª–µ—Ç–µ—Ç—å –Ω–∞ 3 –¥–Ω—è –Ω–∞–∑–∞–¥ –∏ –≤–µ—Ä–Ω—É—Ç—å—Å—è –∫ –¥–µ–¥–ª–∞–π–Ω—É. üîÆ
    // –ë—É–¥–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å, —á—Ç–æ–±—ã –Ω–µ –∑–∞–±—ã—Ç—å, —á—Ç–æ —Å–µ–≥–æ–¥–Ω—è —É–∂–µ –∑–∞–≤—Ç—Ä–∞.

    "database/sql"
    // 7Ô∏è‚É£ –û–ü–ê! "database/sql"? üî•
    // –¢—É—Ç, –∫–∞–∫ –≥–æ–≤–æ—Ä–∏—Ç—Å—è, –≤—Å—ë —Å–µ—Ä—å—ë–∑–Ω–æ. –≠—Ç–∏–º API –º—ã –∑–∞–≤—è–∑—ã–≤–∞–µ–º –Ω–∞—à—É –∂–∏–∑–Ω—å —Å SQL-–±–∞–∑–∞–º–∏.
    // –ó–∞–ø—Ä–æ—Å—ã, –∫–æ–Ω–Ω–µ–∫—Ç—ã, —Å—Ç–∞–∫–∞–Ω—ã —á–∞—è... –≤—Å—ë –≤ –æ–¥–Ω–æ–º —Ñ–ª–∞–∫–æ–Ω–µ.

    "github.com/naluneotlichno/FP-GO-API/database"
    // 8Ô∏è‚É£ –©–∞—Å –±—É–¥–µ—Ç –º–∞–≥–∏—è –ª–æ–∫–∞–ª—å–Ω—ã—Ö –ø–∞–∫–µ—Ç–æ–≤. üé©
    // "database" ‚Äî —Ç–∞–º –≥–¥–µ-—Ç–æ –Ω–∞—à–∞ –≤–æ–ª—à–µ–±–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è GetDB()
    // (–Ω–∞–≤–µ—Ä–Ω–æ–µ, –æ–Ω–∞ –≤—ã–∑–æ–≤–µ—Ç –µ–¥–∏–Ω–æ—Ä–æ–≥–∞, —á—Ç–æ–±—ã –Ω–∞—Å —Å–≤—è–∑–∞—Ç—å —Å MySQL –∏–ª–∏ –µ—â—ë —á–µ–º).

    "github.com/naluneotlichno/FP-GO-API/api"
    // 9Ô∏è‚É£ –ù—É –≤—Å—ë, –ø—Ä–∏–≥–æ—Ç–æ–≤—å—Å—è, ‚Äî "nextdate" –≤–æ—Ä–≤—ë—Ç—Å—è –∏ –ø–µ—Ä–µ—Å–∫–æ—á–∏—Ç —Ç–µ–±—è –≤–æ –≤—Ä–µ–º–µ–Ω–∏.
    // –ï—Å–ª–∏ –¥–µ–¥–ª–∞–π–Ω –ø—Ä–æ—à–µ–ª –≤—á–µ—Ä–∞, –æ–Ω —Ç–µ–ª–µ–ø–æ—Ä—Ç–∏—Ä—É–µ—Ç –∑–∞–¥–∞—á—É –Ω–∞ –ø–æ—Å–ª–µ–∑–∞–≤—Ç—Ä–∞. ü§∑
)

// TaskRequest ‚Äî —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –≤—Ö–æ–¥–Ω–æ–≥–æ JSON-–∑–∞–ø—Ä–æ—Å–∞
type TaskRequest struct {
    Date    string `json:"date"`
    // üò∫ –î–∞–∂–µ –Ω–µ –∑–Ω–∞—é, —á—Ç–æ —Ç—É—Ç –º–æ–∂–µ—Ç –ø–æ–π—Ç–∏ –Ω–µ —Ç–∞–∫. üòº
    // "date" ‚Äî —Å—Ç—Ä–æ–∫–∞. –ï—Å–ª–∏ –ø—É—Å—Ç–∞—è ‚Äî –±—É–¥–µ–º –ø–ª—è—Å–∞—Ç—å –≤–æ–∫—Ä—É–≥ –∫–æ—Å—Ç—Ä–∞ –∏ —Å—Ç–∞–≤–∏—Ç—å —Å–µ–≥–æ–¥–Ω—è—à–Ω—é—é –¥–∞—Ç—É.

    Title   string `json:"title"`
    // üòé "title" ‚Äî –Ω–∞—à–µ –≤—Å—ë. –ë–µ–∑ –Ω–µ–≥–æ –∂–∏–∑–Ω—å —Ç–ª–µ–Ω. –ü–æ–ª–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ! –ü—É—Å—Ç–æ–µ ‚Äî –Ω–µ –≤–∑–ª–µ—Ç–∏–º.

    Comment string `json:"comment,omitempty"`
    // ü§´ comment: –µ—Å–ª–∏ –Ω–µ—Ç –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤ ‚Äî –∏ –Ω–µ –Ω–∞–¥–æ... üòâ
    // –ü–æ–ª–µ –Ω–µ –ø–æ–ø–∞–¥—ë—Ç –≤ JSON, –µ—Å–ª–∏ –ø—É—Å—Ç–æ–µ (—Å–ø–∞—Å–∏–±–æ "omitempty").

    Repeat  string `json:"repeat,omitempty"`
    // üîÅ –ï—Å–ª–∏ –Ω—É–∂–Ω–æ –ø–æ–≤—Ç–æ—Ä—è—Ç—å –∑–∞–¥–∞—á—É —Å–Ω–æ–≤–∞ –∏ —Å–Ω–æ–≤–∞, –∑–∞–ø–∏—Ö–∞–π —Å—é–¥–∞ "DAILY", "WEEKLY" –∏–ª–∏ —á—Ç–æ —É–≥–æ–¥–Ω–æ.
    // –ò —Ç–æ–≥–¥–∞ –ø—Ä–æ—Ü–µ—Å—Å –Ω–∏–∫–æ–≥–¥–∞ –Ω–µ –∫–æ–Ω—á–∏—Ç—Å—è! üòà
}

// TaskResponse ‚Äî —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –æ—Ç–≤–µ—Ç–∞ (id –∏–ª–∏ –æ—à–∏–±–∫–∞)
type TaskResponse struct {
    ID    int64  `json:"id,omitempty"`
    // üòç –ê—Ö, –Ω–∞—à –¥–æ—Ä–æ–≥–æ–π ID! –ï—Å–ª–∏ –∑–∞–ø–∏—Å—å –≤ –ë–î —Ö–æ—Ä–æ—à–æ –∑–∞—à–ª–∞, –±—É–¥–µ—Ç —Ç—É—Ç.

    Error string `json:"error,omitempty"`
    // üíÄ –ï—Å–ª–∏ –º–∏—Ä —Ä—É—à–∏—Ç—Å—è –∏ SQL –Ω–∞—Å –ø—Ä–µ–¥–∞–ª, —Ç—É—Ç –ø–∏—à–µ–º "Error: –≤—Å—ë –ø–ª–æ—Ö–æ, —É—Ö–æ–¥–∏—Ç–µ". 
}

// AddTaskHandler –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç POST-–∑–∞–ø—Ä–æ—Å—ã –Ω–∞ /api/task
func AddTaskHandler(w http.ResponseWriter, r *http.Request) {
    // 1Ô∏è‚É£ –ó–¥–µ—Å—å –º—ã —É—Å—Ç—Ä–∞–∏–≤–∞–µ–º –≥–µ–Ω–∏–∞–ª—å–Ω—É—é –∑–∞—Å–∞–¥—É:
    // –ø—Ä–∏–Ω–∏–º–∞–µ–º –∫–ª–∏–µ–Ω—Ç–∞, –ø—Ä–æ–≤–µ—Ä—è–µ–º, –ø–æ—Å—Ç—É—á–∞–ª—Å—è –ª–∏ –æ–Ω POST'–æ–º,
    // –∏ —Ç–≤–æ—Ä–∏–º –º–∞–≥–∏—é –≤—Å—Ç–∞–≤–∫–∏ –∑–∞–¥–∞—á–∏.

    if r.Method != http.MethodPost {
        // üî® –ï—Å–ª–∏ –º—É–∂–∏–∫ –Ω–µ "POST", —Ç–æ –º—ã –µ–≥–æ –∫—É–≤–∞–ª–¥–æ–π –ø–æ 405 Method Not Allowed! üî•
        http.Error(w, `{"error": "–ú–µ—Ç–æ–¥ –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è"}`, http.StatusMethodNotAllowed)
        // üíÖ –ü—Ä–∏ —ç—Ç–æ–º –≥–æ–≤–æ—Ä–∏–º "—Å–æ—Ä—è–Ω, –±—Ä–∞—Ç, –º—ã —Ç—É—Ç —Ç–æ–ª—å–∫–æ POST-–º–µ—Ç–æ–¥—ã –ª—é–±–∏–º". 
        return
    }

    // ‚úÖ –î–µ–∫–æ–¥–∏—Ä—É–µ–º JSON-–∑–∞–ø—Ä–æ—Å
    var req TaskRequest
    // –≠—Ç–æ –Ω–∞—à–∏ –ø–æ—á—Ç–æ–≤—ã–µ —è—â–∏–∫–∏ –¥–ª—è –¥–∞–Ω–Ω—ã—Ö –æ—Ç –∫–ª–∏–µ–Ω—Ç–∞.

    if err := json.NewDecoder(r.Body).Decode(&req); err != nil {
        // üèÜ –û–ô-–û–ô, –ù–ï –°–ú–û–ì–õ–ò –†–ê–°–ü–ê–†–°–ò–¢–¨ JSON?
        log.Printf("‚ùå –û—à–∏–±–∫–∞ –¥–µ—Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏–∏ JSON: %v", err)
        // –õ–æ–≥–∏—Ä—É–µ–º –ø–æ–∑–æ—Ä –Ω–∞ –≤—Å—é –∫–æ–Ω—Å–æ–ª—å, —á—Ç–æ–±—ã –ø–æ—Ç–æ–º –±—ã–ª–æ, –æ —á—ë–º –¥–µ—Ç—è–º —Ä–∞—Å—Å–∫–∞–∑–∞—Ç—å. üò≠
        http.Error(w, `{"error": "–û—à–∏–±–∫–∞ –¥–µ—Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏–∏ JSON"}`, http.StatusBadRequest)
        // –í—ã–¥–∞–µ–º –æ—à–∏–±–∫—É 400 –∏ –≥–æ–≤–æ—Ä–∏–º: "–ù–µ —É–º–µ–µ—à—å JSON –ø–∏—Å–∞—Ç—å ‚Äî –Ω–µ –≥–æ–≤–æ—Ä–∏ —Å –Ω–∞–º–∏".
        return
    }

    // ‚úÖ –ü—Ä–æ–≤–µ—Ä—è–µ–º –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è
    if req.Title == "" {
        // üòÇ "title" –ø—É—Å—Ç–æ–π? –≠—Ç–æ –∫–∞–∫ –≤—ã–π—Ç–∏ –Ω–∞ —É–ª–∏—Ü—É –≥–æ–ª—ã–º! 
        // –ù–µ –Ω—É –ø—Ä–∞–≤–¥–∞, –∫–∞–∫ —Ç–∞–∫-—Ç–æ –±–µ–∑ –∑–∞–≥–æ–ª–æ–≤–∫–∞?
        http.Error(w, `{"error": "–ù–µ —É–∫–∞–∑–∞–Ω –∑–∞–≥–æ–ª–æ–≤–æ–∫ –∑–∞–¥–∞—á–∏"}`, http.StatusBadRequest)
        // –ñ–∞–ª—É–µ–º—Å—è –∫–ª–∏–µ–Ω—Ç—É, —á—Ç–æ "Title" ‚Äî –Ω–∞—à–µ —Å–≤—è—Ç–æ–µ. üëº
        return
    }

    // ‚úÖ –ï—Å–ª–∏ –¥–∞—Ç–∞ –ø—É—Å—Ç–∞—è ‚Äî –ø–æ–¥—Å—Ç–∞–≤–ª—è–µ–º —Ç–µ–∫—É—â—É—é
    if req.Date == "" {
        // ‚è≥ –ï—Å–ª–∏ "date" –Ω–µ –∑–∞–¥–∞–ª–∏, –º—ã —é–∑–∞–µ–º —Å–µ–≥–æ–¥–Ω—è—à–Ω—é—é.
        // –≠—Ç–æ –∫–∞–∫ –ø—Ä–∏–π—Ç–∏ –≤ –∫–ª—É–± –±–µ–∑ –¥–∞—Ç—ã ‚Äî –±–µ—Ä—ë—à—å —Å–ª—É—á–∞–π–Ω—É—é –ø—Ä—è–º–æ –Ω–∞ –º–µ—Å—Ç–µ! ü§™
        req.Date = time.Now().Format("20060102")
    }

    // ‚úÖ –ü–∞—Ä—Å–∏–º –¥–∞—Ç—É, –µ—Å–ª–∏ —Ñ–æ—Ä–º–∞—Ç –∫—Ä–∏–≤–æ–π ‚Äî —à–ª—ë–º –æ—à–∏–±–∫—É
    taskDate, err := time.Parse("20060102", req.Date)
    // üòè time.Parse ‚Äî —á—É–≤–∞–∫ —Å—É—Ä–æ–≤—ã–π, –µ—Å–ª–∏ –Ω–µ –≤–∏–¥–∏—Ç 8 —Ü–∏—Ñ—Ä (YYYYMMDD), –æ–Ω –ø–æ—à–ª—ë—Ç –Ω–∞—Å –∫ —á—ë—Ä—Ç—É.

    if err != nil {
        // ü•¥ –í–∏–¥–∏–º–æ —Ñ–æ—Ä–º–∞—Ç –∫—Ä–∏–≤–æ–π: "2025-01-16" –∏–ª–∏ "–æ–ª–æ–ª–æ123"? –ú–∏–º–æ –∫–∞—Å—Å—ã!
        http.Error(w, `{"error": "–î–∞—Ç–∞ —É–∫–∞–∑–∞–Ω–∞ –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ"}`, http.StatusBadRequest)
        // –ì–æ–Ω–∏–º –≤–∑–∞—à–µ–π –∫–ª–∏–µ–Ω—Ç–∞, –∏–±–æ –Ω–µ —É–º–µ–µ—Ç –≤ –Ω–∞—à—É –¥–∞—Ç—É!
        return
    }

    // ‚úÖ –ï—Å–ª–∏ –¥–∞—Ç–∞ –≤ –ø—Ä–æ—à–ª–æ–º ‚Äî –ø—Ä–∏–º–µ–Ω—è–µ–º –ø—Ä–∞–≤–∏–ª–æ –ø–æ–≤—Ç–æ—Ä–µ–Ω–∏—è
    if taskDate.Before(time.Now()) {
        // ‚è≤ .Before() –ø—Ä–æ–≤–µ—Ä—è–µ—Ç, —Å—Ç–æ–∏—Ç –ª–∏ –¥–∞—Ç–∞ –¥–æ —Ç–µ–∫—É—â–µ–≥–æ –º–æ–º–µ–Ω—Ç–∞.
        // –ï—Å–ª–∏ –¥–∞, –∑–Ω–∞—á–∏—Ç ¬´–ì–ì¬ª, –º—ã –ø—Ä–æ—Å—Ä–æ—á–∏–ª–∏ –¥–µ–¥–ª–∞–π–Ω. üò±

        if req.Repeat != "" {
            // üåÄ –ï—Å–ª–∏ –µ—Å—Ç—å –ø—Ä–∞–≤–∏–ª–æ –ø–æ–≤—Ç–æ—Ä–µ–Ω–∏—è, –∫—Ä—É—Ç–∏–º –Ω–∞—à –≤–æ–ª—á–æ–∫ –¥–∞–ª—å—à–µ!
            nextDate, err := nextdate.NextDate(time.Now(), req.Date, req.Repeat)
            // üîÆ "NextDate" –∏–∑ –ø–∞–∫–µ—Ç–∞ "nextdate" –º–∞–≥–∏—á–µ—Å–∫–∏–º –æ–±—Ä–∞–∑–æ–º –≤—ã—á–∏—Å–ª–∏—Ç, 
            // –∫—É–¥–∞ –ø–µ—Ä–µ–Ω–æ—Å–∏—Ç—å –ø—Ä–æ—Å—Ä–æ—á–µ–Ω–Ω—É—é –∑–∞–¥–∞—á—É (–Ω–∞–ø—Ä–∏–º–µ—Ä, –Ω–∞ –∑–∞–≤—Ç—Ä–∞).

            if err != nil {
                // üíî –ï—Å–ª–∏ —Ñ–æ—Ä–º–∞—Ç –ø–æ–≤—Ç–æ—Ä–∞ –Ω–∞–º –Ω–µ –ø–æ–Ω—Ä–∞–≤–∏–ª—Å—è, –±–∞—Ö–∞–µ–º 400.
                http.Error(w, fmt.Sprintf(`{"error": "–ù–µ–≤–µ—Ä–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç –ø—Ä–∞–≤–∏–ª–∞ –ø–æ–≤—Ç–æ—Ä–µ–Ω–∏—è: %s"}`, err.Error()), http.StatusBadRequest)
                // –í—Å—ë, –¥–æ —Å–≤–∏–¥—É–ª—å–∫–∏.
                return
            }
            req.Date = nextDate
            // ü§ô –í–æ—Ç –∏ –≤—Å—ë, —É –Ω–∞—Å –Ω–æ–≤–µ–Ω—å–∫–∞—è –¥–∞—Ç–∞ –≤ –±—É–¥—É—â–µ–º. –ù–∞—á–∏–Ω–∞–µ–º —Ç—É—Å–æ–≤–∞—Ç—å—Å—è –∑–∞–Ω–æ–≤–æ!

        } else {
            // ü§∑ –ï—Å–ª–∏ –ø–æ–≤—Ç–æ—Ä–∞ –Ω–µ—Ç, –∞ –¥–∞—Ç–∞ —É—à–ª–∞ –≤ –ø—Ä–æ—à–ª–æ–µ ‚Äî –∑–Ω–∞—á–∏—Ç —Å—Ç–∞–≤–∏–º ¬´—Å–µ–≥–æ–¥–Ω—è¬ª –∏ –Ω–µ –º–æ—Ä–æ—á–∏–º –≥–æ–ª–æ–≤—É.
            req.Date = time.Now().Format("20060102")
        }
    }

    // ‚úÖ –ü–æ–¥–∫–ª—é—á–∞–µ–º—Å—è –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö
    db, err := database.GetDB()
    // üîë –í—ã–∑—ã–≤–∞–µ–º –Ω–∞—à—É –≤–æ–ª—à–µ–±–Ω—É—é —Ñ—É–Ω–∫—Ü–∏—é GetDB() –∏–∑ –ø–∞–∫–µ—Ç–∞ "database". 
    // –ù–∞–¥–µ–µ–º—Å—è, —á—Ç–æ –æ—Ç–∫—Ä–æ–µ—Ç—Å—è –ø–æ—Ä—Ç–∞–ª –≤ –º–∏—Ä SQL.

    if err != nil {
        // üîí –ï—Å–ª–∏ –ø–æ—Ä—Ç–∞–ª –∑–∞–∫—Ä—ã—Ç, –∑–Ω–∞—á–∏—Ç –≤—Å—ë, –≤–∑—Ä—ã–≤–∞–µ–º—Å—è 500 (Internal Server Error).
        http.Error(w, `{"error": "–û—à–∏–±–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ –ë–î"}`, http.StatusInternalServerError)
        return
    }

    // ‚úÖ –í—Å—Ç–∞–≤–ª—è–µ–º –Ω–æ–≤—É—é –∑–∞–¥–∞—á—É –≤ –±–∞–∑—É
    query := `INSERT INTO scheduler (date, title, comment, repeat) VALUES (?, ?, ?, ?)`
    // SQL-–∑–∞–ø—Ä–æ—Å: "–°—ç—Ä, –ø–æ–ª–æ–∂–∏—Ç–µ –¥–∞—Ç—É, –∑–∞–≥–æ–ª–æ–≤–æ–∫, –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π –∏ –ø–æ–≤—Ç–æ—Ä –≤ —Ç–∞–±–ª–∏—Ü—É scheduler!"
    // –ò–Ω–∞—á–µ –≤—Å–µ –≤–∑–æ—Ä–≤—ë—Ç—Å—è! üí£

    res, err := db.Exec(query, req.Date, req.Title, req.Comment, req.Repeat)
    // –í–æ—Ç –æ–Ω–∞: —à–∏–∫, –±–ª–µ—Å–∫, –∫—Ä–∞—Å–æ—Ç–∞. –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –∑–∞–ø—Ä–æ—Å –≤ –±–∞–∑—É:
    // "–ü—Ä–∏–≤–µ—Ç, –±–∞–∑–∞, –¥–∞–π –Ω–∞–º –Ω–æ–≤—É—é –∑–∞–¥–∞—á—É!"

    if err != nil {
        // ü§¨ –ï—Å–ª–∏ –±–∞–∑–∞ –∑–∞—è–≤–∏–ª–∞: "–§–∏–≥ —Ç–µ–±–µ, –∞ –Ω–µ INSERT", 
        // —Ç–æ–≥–¥–∞ –≤–æ–∑–≤—Ä–∞—â–∞–µ–º –∫–æ–¥ 500 –∏ –≤–∞–ª–∏–º –≤ –∑–∞–∫–∞—Ç.
        http.Error(w, `{"error": "–û—à–∏–±–∫–∞ –∑–∞–ø–∏—Å–∏ –≤ –ë–î"}`, http.StatusInternalServerError)
        return
    }

    // ‚úÖ –ü–æ–ª—É—á–∞–µ–º ID –Ω–æ–≤–æ–π –∑–∞–¥–∞—á–∏
    taskID, err := res.LastInsertId()
    // lastInsertId() ‚Äî —ç—Ç–æ –∫–∞–∫ —Å–ø—Ä–∞—à–∏–≤–∞—Ç—å —É –±–∞–∑—ã: "–ù—É –∏ –∫–∞–∫–æ–π —É –º–µ–Ω—è —Ç–µ–ø–µ—Ä—å ID, —à–µ—Ñ?" 
    // –û–Ω–∞ —Ç–∞–∫–∞—è: "–ù—É –¥–µ—Ä–∂–∏, 108". 

    if err != nil {
        // üôà –ï—Å–ª–∏ –±–∞–∑–∞ —Å–∫–∞–∑–∞–ª–∞ "–Ω–µ –∑–Ω–∞—é —è –Ω–∏–∫–∞–∫–∏—Ö ID",
        // –≤—ã–¥–∞—ë–º 500, –∏–±–æ –±–µ–¥–∞.
        http.Error(w, `{"error": "–û—à–∏–±–∫–∞ –ø–æ–ª—É—á–µ–Ω–∏—è ID –∑–∞–ø–∏—Å–∏"}`, http.StatusInternalServerError)
        return
    }

    // ‚úÖ –í–æ–∑–≤—Ä–∞—â–∞–µ–º JSON-–æ—Ç–≤–µ—Ç –≤ —Ñ–æ—Ä–º–∞—Ç–µ, –∫–æ—Ç–æ—Ä—ã–π –æ–∂–∏–¥–∞–µ—Ç —Ç–µ—Å—Ç
    resp := TaskResponse{ID: taskID}
    // –°–æ–∑–¥–∞—ë–º –æ—Ç–≤–µ—Ç, –≥–¥–µ ID = –≤–æ–ª—à–µ–±–Ω–æ–µ —á–∏—Å–ª–æ, –∫–æ—Ç–æ—Ä–æ–µ –Ω–∞–º –≤–µ—Ä–Ω—É–ª–∞ –±–∞–∑–∞. üîÆ

    w.Header().Set("Content-Type", "application/json; charset=UTF-8")
    // –ò–≥—Ä–∏–≤–æ —à–µ–ø—á–µ–º –∫–ª–∏–µ–Ω—Ç—É –≤ –∑–∞–≥–æ–ª–æ–≤–∫–∞—Ö, —á—Ç–æ –º—ã –±—É–¥–µ–º –≥–æ–≤–æ—Ä–∏—Ç—å –Ω–∞ —è–∑—ã–∫–µ JSON –≤ UTF-8. ü¶ú

    json.NewEncoder(w).Encode(resp)
    // –ò, –Ω–∞–∫–æ–Ω–µ—Ü, –∫–æ–¥–∏—Ä—É–µ–º –Ω–∞—à—É —Å—Ç—Ä—É–∫—Ç—É—Ä—É –≤ JSON –∏ –≤–ø–∏—Ö–∏–≤–∞–µ–º –≤ –æ—Ç–≤–µ—Ç –∫–ª–∏–µ–Ω—Ç—É.
    // –ë–ê–ú! –í—Å—ë, –∑–∞–¥–∞—á–∫–∞ –∑–∞–ø–∏—Å–∞–Ω–∞, ID –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω. –ü—Ä–æ—Ñ–∏—Ç! üçæ
}